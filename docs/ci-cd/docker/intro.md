# Docker

## Введение

Докер позволяет единообразно разворачивать и управлять приложениями независимо от их стека.

Основные термины:
- Container
- Image
- Registry
- Dockerfile

Container - изолированная среда, в которой запущено приложение. Экземпляр Image. Image определяет окружение и доступные инструменты внутри Container.

Image - настроенная файловая система для Container. Содержит все, что необходимо для запуска приложения.

Registry - место хранения всех образов приложения.

Dockerfile - инструкция по созданию Image.

Простейший сценарий использования Docker выглядит так:
1. На основе приложения создаем Image
2. Image храним в Registry. Публичном или приватном.
3. На сервере где будет запущено приложения скачиваем Image, запускаем Container, указывая порт, на котором будет работать приложение.

## Как создать Image

Создаем .Dockerfile

Помним, что кэширование происходит по строкам.

```docker
FROM node:18-alpine
WORKDIR /app
COPY . .
RUN yarn install --production
CMD ["node", "src/index.js"]
EXPOSE 3000
```

Команда для создания Image

```sh
docker build -t image-name:0.0.1 .
```

Команда для запуска Container

```sh
docker run -p 127.0.0.1:3000:3000 image-name:0.0.1
```

docker --help поможет в остальном

## Удаленное подключение

Проблема: просмотр состояния контейнеров, информации о них, возможность перезапустить на удаленном сервере.

1. Установить Docker Desktop
2. Установить расширение Portainer
3. Добавить новое окружение (новый хост)

Расширение позволит решить проблему.
